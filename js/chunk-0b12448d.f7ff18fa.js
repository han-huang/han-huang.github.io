(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b12448d"],{"4cea":function(t,e,r){"use strict";var s=r("d5f5"),a=r.n(s);a.a},d5f5:function(t,e,r){},e116:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-row",[r("div",{staticClass:"col-md-12"},[r("div",{staticClass:"progressbar-container text-center"},[r("ul",{staticClass:"progressbar"},[r("li",{staticClass:"progressbar-done"},[t._v("檢視購物車")]),r("li",{staticClass:"progressbar-done"},[t._v("付款方式及寄送資訊")]),r("li",{staticClass:"progressbar-active"},[t._v("確認訂單資料")]),r("li",[t._v("訂單成立")])])])])]),r("b-row",{staticClass:"mt-3"},[r("b-col",{attrs:{md:"12"}},[r("b-card",{attrs:{header:"確認購物清單","header-text-variant":"dark","header-tag":"header","header-bg-variant":"muted"}},[r("b-table",{ref:"selectableTable",attrs:{striped:"",hover:"",stacked:"lg",fields:t.fields,items:t.items},scopedSlots:t._u([{key:"cell()",fn:function(e){return[r("span",{domProps:{textContent:t._s(e.value)}})]}},{key:"cell(name)",fn:function(e){return[r("router-link",{staticClass:"text-decoration-none text-primary",attrs:{to:"/product/"+e.item.isbn}},[r("span",{domProps:{textContent:t._s(e.value)}})])]}},{key:"cell(salePrice)",fn:function(e){return[r("span",{domProps:{textContent:t._s(t.salePrice(e))}})]}},{key:"cell(subtotal)",fn:function(e){return[r("span",{domProps:{textContent:t._s(t.calSubTotal(e))}})]}}])}),r("div",{staticClass:"d-flex bg-light"},[r("div",{staticClass:"ml-auto"},[r("p",{staticClass:"mt-3 mr-3"},[t._v(" 共 "),r("span",{staticClass:"text-danger"},[t._v(t._s(t.items.length))]),t._v(" 項商品，數量 "),r("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.totalQuantity())}}),t._v(" 個，總金額 NT$ "),r("span",{staticClass:"text-danger",domProps:{textContent:t._s(t.totalAmount())}}),t._v(" 元 ")])])])],1)],1)],1),r("b-row",{staticClass:"mt-3"},[r("b-col",{attrs:{md:"12"}},[r("b-card",{attrs:{header:"付款方式及寄送資訊","header-text-variant":"dark","header-tag":"header","header-bg-variant":"muted"}},[r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"deliver"}},[t._v("配送方式")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"deliver"}},[t._v(t._s(t.getDeliver))])])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"payment"}},[t._v("付款方式")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"payment"}},[t._v(t._s(t.getPayment))])])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"invoiceType"}},[t._v("發票資訊")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"invoiceType"}},[t._v(t._s(t.getInvoiceType))])])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"buyerName"}},[t._v("訂購人")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"buyerName"},domProps:{textContent:t._s(t.getBuyer.name)}})])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"buyerContactNumber"}},[t._v("訂購人聯絡電話")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"buyerContactNumber"},domProps:{textContent:t._s(t.getBuyer.contactNumber)}})])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"buyerMobile"}},[t._v("訂購人手機號碼")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"buyerMobile"},domProps:{textContent:t._s(t.getBuyer.mobile)}})])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"buyerAddress"}},[t._v("訂購人地址")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"buyerAddress"},domProps:{textContent:t._s(t.getBuyer.address)}})])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"receiverName"}},[t._v("收件人")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"receiverName"},domProps:{textContent:t._s(t.getReceiverName)}})])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"receiverContactNumber"}},[t._v("收件人聯絡電話")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"receiverContactNumber"}},[t._v(t._s(t.getContactNumber))])])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"receiverMobile"}},[t._v("收件人手機號碼")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"receiverMobile"}},[t._v(t._s(t.getMobile))])])],1),r("b-row",{},[r("b-col",{staticClass:"d-flex align-items-center ml-1",attrs:{md:"2"}},[r("label",{attrs:{for:"receiverAddress"}},[t._v("收件人地址")])]),r("b-col",{staticClass:"ml-1",attrs:{md:"9"}},[r("span",{attrs:{id:"receiverAddress"}},[t._v(t._s(t.getAddress))])])],1)],1),r("div",{staticClass:"d-flex justify-content-end mt-3"},[r("b-button",{staticClass:"mr-3",attrs:{variant:"outline-primary"},on:{click:function(e){return t.goDeliver()}}},[r("font-awesome-icon",{attrs:{icon:["fas","angle-double-left"]}}),t._v(" 上一步 ")],1),r("b-button",{staticClass:"mr-3",attrs:{variant:"outline-primary"},on:{click:t.checkout}},[t._v(" 確認送出 "),r("font-awesome-icon",{attrs:{icon:["fas","angle-double-right"]}})],1)],1)],1)],1),r("b-modal",{ref:"order-modal",attrs:{"hide-footer":"",title:"Demo Site"},on:{hide:t.backToHome}},[r("div",{staticClass:"d-block text-center"},[r("p",[t._v(" 感謝您的訂購，您已經完成本筆交易的訂購程序，我們將會盡快為您處理訂單並安排出貨。 ")]),r("b-table",{attrs:{stacked:"",items:t.orderItems}}),r("p",[r("a",{staticClass:"text-decoration-none",attrs:{href:"javascript:void(0)"},on:{click:t.orderDetail}},[t._v("查看訂單詳情")])]),r("img",{attrs:{src:t.getQRCode,alt:"QRCode"}})],1)])],1)},a=[],i=(r("4de4"),r("d81d"),r("13d5"),r("b0c0"),r("b85c")),o=r("5530"),n=r("2f62"),c=r("a49b"),l=(r("7947"),r("ecee")),d=r("c074"),m=r("5ce5"),u=r("325c");r("8897");l["c"].add(d["b"],d["a"]);var b={name:"Confirm",data:function(){return{fields:c["b"].confirmFields,orderNo:"20201130092604879QTP",orderDate:"2020-11-30 09:26:05",orderAmount:2127,orderItems:[],QRCode:""}},components:{},computed:Object(o["a"])(Object(o["a"])({items:function(){return this.$store.getters["cart/cartProducts"]},getDeliver:function(){return"homeDelivery"===this.getState().deliver?"宅配":"郵寄"},getPayment:function(){return"COD"===this.getState().payment?"貨到付款":""},getInvoiceType:function(){return"paper"===this.getState().invoiceType?"紙本發票":""},getReceiverName:function(){return this.isReceiverInfoNew()?this.getState().receiverName:this.getBuyer.name},getContactNumber:function(){if(this.isReceiverInfoNew()){var t=0==this.getState().receiverExt.length?"":" 分機 "+this.getState().receiverExt;return this.getState().receiverArea+"-"+this.getState().receiverPhone+t}return this.getBuyer.contactNumber},getMobile:function(){return this.isReceiverInfoNew()?this.getState().receiverMobile:this.getBuyer.mobile},getAddress:function(){return this.isReceiverInfoNew()?this.getState().zipcode+this.getState().county+this.getState().district+this.getState().receiverAddress:this.getBuyer.address}},Object(n["c"])("auth",["getBuyer"])),{},{getQRCode:function(){return this.QRCode}}),methods:Object(o["a"])(Object(o["a"])({},Object(n["c"])("deliver",["getState"])),{},{isReceiverInfoNew:function(){return"new"===this.getState().receiverInfo},goDeliver:function(){this.$router.push({name:"deliver"})},salePrice:function(t){return t.item.salePrice=this.calSalePrice(t.item.listPrice,t.item.discount),t.item.salePrice},calSalePrice:function(t,e){return Math.round(t*e/100)},calSubTotal:function(t){return t.item.salePrice*t.item.quantity},totalQuantity:function(){return this.items.map((function(t){return isNaN(t.quantity)||0==t.quantity.length?0:parseInt(t.quantity,10)})).reduce((function(t,e){return t+e}),0)},totalAmount:function(){var t=this;return this.items.map((function(e){var r;return r=isNaN(e.quantity)||0==e.quantity.length?0:parseInt(e.quantity,10),t.calSalePrice(e.listPrice,e.discount)*r})).reduce((function(t,e){return t+e}),0)},createReqObj:function(){for(var t=this.items.map((function(t){var e={};return e["isbn"]=t.isbn,e["quantity"]=t.quantity,e})),e=JSON.parse(JSON.stringify(this.getState())),r=["receiverNameState","receiverAreaState","receiverPhoneState","receiverExtState","receiverMobileState","receiverAddressState"],s=0,a=r;s<a.length;s++){var i=a[s];delete e[i]}console.log(JSON.stringify(t),JSON.stringify(e));var o={};return o["bookList"]=t,o["deliver"]=e,o},checkout:function(){var t=this,e=this.items.filter((function(t){return 0==t.quantity.length}));if(console.log(JSON.stringify(e)),e.length){var r,s=Object(i["a"])(e);try{for(s.s();!(r=s.n()).done;){r.value;this.$toastr.e("請修改為正確的數量")}}catch(o){s.e(o)}finally{s.f()}}else{var a=this.createReqObj();console.log(JSON.stringify(a)),m["a"].setHeader(),m["a"].post("order/create",a).then((function(e){console.log("Confirm.vue checkout response : "+JSON.stringify(e)),m["a"].deleteHeader(),t.$store.dispatch("cart/clearState"),t.$store.dispatch("deliver/clearState"),t.completeOrder(e.data),t.$router.push({name:"complete"})})).catch((function(e){console.log("err : "+e),console.log("err JSON.stringify : "+JSON.stringify(e)),console.log("err.response : "+JSON.stringify(e.response)),m["a"].deleteHeader();var r="";e.response.data.errors?(r="數量不可為 0 , 請修改訂單",console.log("err.response.data.errors",e.response.data.errors)):(console.log("err.response.data.message",e.response.data.message),r=u["a"].checkJWTExpired(e,t)),t.$store.dispatch("modal/setModalMsg",r),t.$store.dispatch("modal/setModalShow",!0)}))}},completeOrder:function(t){var e={"訂單編號":t.orderNo,"訂單日期":t.orderDate,"訂單金額":t.orderAmount},r=[e];this.$store.dispatch("complete/setOrderItems",r),this.$store.dispatch("complete/setQRCode",t.qrcode),this.$store.dispatch("complete/setOrderNo",t.orderNo)},showOrder:function(t){this.orderNo=t.orderNo;var e={"訂單編號":t.orderNo,"訂單日期":t.orderDate,"訂單金額":t.orderAmount};this.QRCode=t.qrcode;var r=[e];this.orderItems=JSON.parse(JSON.stringify(r)),this.$refs["order-modal"].show()},showModal:function(){var t={"訂單編號":this.orderNo,"訂單日期":this.orderDate,"訂單金額":this.orderAmount},e=[t];this.orderItems=JSON.parse(JSON.stringify(e)),this.$refs["order-modal"].show()},orderDetail:function(){this.$router.push({path:"/order/".concat(this.orderNo)}).catch((function(t){return console.log(t)}))},backToHome:function(){this.$router.push({name:"index"})}}),mounted:function(){},created:function(){}},f=b,v=(r("4cea"),r("2877")),h=Object(v["a"])(f,s,a,!1,null,null,null);e["default"]=h.exports}}]);
//# sourceMappingURL=chunk-0b12448d.f7ff18fa.js.map